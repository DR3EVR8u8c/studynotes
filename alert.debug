DEBUG!
Start: Fri, 20 Apr 2018 20:23:14 +1000
ClearStaleAlerts():
SQL[[0;33mSELECT `alerts`.`id` AS `alert_id`, `devices`.`hostname` AS `hostname` FROM `alerts` LEFT JOIN `devices` ON `alerts`.`device_id`=`devices`.`device_id`  RIGHT JOIN `alert_rules` ON `alerts`.`rule_id`=`alert_rules`.`id` WHERE `alerts`.`state`!=0 AND `devices`.`hostname` IS NULL[0m] 
RunFollowUp():
SQL[[0;33mSELECT alerts.id, alerts.device_id, alerts.rule_id, alerts.state FROM alerts WHERE alerts.state != 2 && alerts.state > 0 && alerts.open = 0[0m] 
RunAlerts():
SQL[[0;33mSELECT alerts.id, alerts.device_id, alerts.rule_id, alerts.state FROM alerts WHERE alerts.state != 2 && alerts.open = 1[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '22' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='22' OR dg.device_id='22')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '25' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='25' OR dg.device_id='25')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '28' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='28' OR dg.device_id='28')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '21' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='21' OR dg.device_id='21')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '2' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='2' OR dg.device_id='2')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '2' && alert_log.rule_id = '8' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '3' && alert_log.rule_id = '7' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='3' OR dg.device_id='3')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '3' && alert_log.rule_id = '8' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '4' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='4' OR dg.device_id='4')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '12' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='12' OR dg.device_id='12')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '12' && alert_log.rule_id = '8' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '39' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='39' OR dg.device_id='39')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '17' && alert_log.rule_id = '12' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='17' OR dg.device_id='17')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '18' && alert_log.rule_id = '12' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='18' OR dg.device_id='18')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '82' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='82' OR dg.device_id='82')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '84' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='84' OR dg.device_id='84')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '103' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='103' OR dg.device_id='103')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '101' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='101' OR dg.device_id='101')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '95' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='95' OR dg.device_id='95')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '91' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='91' OR dg.device_id='91')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '54' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='54' OR dg.device_id='54')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '53' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='53' OR dg.device_id='53')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '50' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='50' OR dg.device_id='50')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '55' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='55' OR dg.device_id='55')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '69' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='69' OR dg.device_id='69')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '62' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='62' OR dg.device_id='62')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '61' && alert_log.rule_id = '1' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='61' OR dg.device_id='61')[0m] 
SQL[[0;33mSELECT alert_log.id,alert_log.rule_id,alert_log.device_id,alert_log.state,alert_log.details,alert_log.time_logged,alert_rules.rule,alert_rules.severity,alert_rules.extra,alert_rules.name FROM alert_log,alert_rules WHERE alert_log.rule_id = alert_rules.id && alert_log.device_id = '45' && alert_log.rule_id = '12' && alert_rules.disabled = 0 ORDER BY alert_log.id DESC LIMIT 1[0m] 
SQL[[0;33mSELECT DISTINCT a.* FROM alert_rules a  LEFT JOIN alert_device_map d ON a.id=d.rule_id  LEFT JOIN alert_group_map g ON a.id=g.rule_id  LEFT JOIN device_group_device dg ON g.group_id=dg.device_group_id  WHERE a.disabled = 0 AND ((d.device_id IS NULL AND g.group_id IS NULL) OR d.device_id='45' OR dg.device_id='45')[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '22' && devices.device_id = alerts.device_id && alerts.rule_id = '7'[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '25' && devices.device_id = alerts.device_id && alerts.rule_id = '7'[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '28' && devices.device_id = alerts.device_id && alerts.rule_id = '7'[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '21' && devices.device_id = alerts.device_id && alerts.rule_id = '7'[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '2' && devices.device_id = alerts.device_id && alerts.rule_id = '7'[0m] 
SQL[[0;33mSELECT alerts.alerted,devices.ignore,devices.disabled FROM alerts,devices WHERE alerts.device_id = '2' && devices.device_id = alerts.device_id && alerts.rule_id = '8'[0m] 
SQL[[0;33mSELECT `device_group_id` FROM `device_group_device` WHERE `device_id`='2'[0m] 
SQL[[0;33mSELECT alert_schedule.schedule_id FROM alert_schedule LEFT JOIN alert_schedule_items ON alert_schedule.schedule_id=alert_schedule_items.schedule_id WHERE ( alert_schedule_items.target = '2' ) && ((alert_schedule.recurring = 0 AND (NOW() BETWEEN alert_schedule.start AND alert_schedule.end)) OR (alert_schedule.recurring = 1 AND (alert_schedule.start_recurring_dt <= date_format(NOW(), '[1;33m-[0;35m-%d') AND (end_recurring_dt >= date_format(NOW(), '[1;33m-[0;35m-%d') OR end_recurring_dt is NULL OR end_recurring_dt = '0000-00-00' OR end_recurring_dt = '')) AND (date_format(now(), '%H:%i:%s') BETWEEN `start_recurring_hr` AND end_recurring_hr) AND (recurring_day LIKE CONCAT('%',date_format(now(), '[0;37m'),'%') OR recurring_day is null or recurring_day = ''))) LIMIT 1[0m] 
SQL[[0;33mUPDATE `alert_log` set `details` ='x⁄ÖU€n„6˝AO-∞QDZæÈ©NÇE¨ΩFÉbÅm\nÅñ∏\nw)í‡EÆÏøwFí-€5P œô3ú·Ã˙=.µÚ¨Ù.Œﬂc´knì=Sıo\roæsüî∫âÛ8˛˘!∂AÚ8ˇÎ=Æx+J^à\n4˛øiÁk¿≥@ÓÑÚw¶\n$MÜ#§.ôû;∏Õ\r\ZxÑhJ2If¿ qîpô∞ì¢êˇ&yÀeú´ eÙπG€0ÁŒm&k}¥K{0^ü3z‰ú„TcZn!oK1©—÷c}3Ü∑Lπ	ïAD4\\å∂‹[¡›˘aE%€a˜bºÌÆ6ü∞%´ëtpüwﬂyÈüüÄìêz\03¸Dùù%ãæÖO‹ïX€j˚}·ª◊˚óÕz≠ôb5o∏Ú—#≥UÙÀ˙!o1>ç∂ÛvÒY¥›‰Ãî≈€>ùLªbñe…N®hıë)´\r9ÊCÎmΩ…W€˘í¶—Ô‰4zŸ‰—◊ôßYJ&d2è÷OyJ^ÔÈ~S2ˇµØ¯±‘¸ß˙°Ù^˝uB+º«ÁóhH˛z≠å,‹dœ,Ôn€\'~@¡}„Ã;ˆÊ˚”∆⁄°––y‡£INFa9s] ØV⁄ß3Ã™\ZÃ`pæ®Ù˘|:ôgàAßï/NÑ$sæ0ZˆÅp˘≈]ö›—4¢i?zŒ)ò˜º1π√\r∆OıÏ«‚&…Ç#°∞RCﬂÆ(tö–Â9óUêE>[1mùû™™˛ü:Åqëá$hÇ5⁄ùˆÕ∂¿Ë=,4ó[ªû«Á≤¿ó]ØaâkÎnß‡Æ∂®≠fh!÷mE≈êÃßq¢ËR⁄è”∆Â+`Åu):N—ËäáÀï”∂öHüzÄ*.π?Mu\0KŸ=q´•á°éu\r◊¬ÂŸ∫;ˆ∆vBkf\0M‡8Œ PˇÁ≤≤·‡Aó«“˙ç~Vûë≠ÄˇóÒMê^)¯^kAîó◊ì¢—…2°Wpã•NÔœπCÍ=û=üı/ŒïÎVÉñ˘ÎzúÔæ96\Z@®l˚vpΩÁ°\'7–¢ÅùΩvS1œoj9ìÀ€éÉ–`Ò-®≤˚⁄˙¥ß<∑-™íLiF…ræÃ~˛Ù1' WHERE id = '1463'[0m] 
SQL[[0;33mSELECT count(*) from `device_relationships` WHERE `child_device_id` = '2'[0m] 
SQL[[0;33mSELECT attrib_value FROM devices_attribs WHERE attrib_type = "disable_notify" && device_id = '2'[0m] 
SQL[[0;33mSELECT hostname, sysName, sysDescr, hardware, version, location, purpose, notes, uptime FROM devices WHERE device_id = '2'[0m] 
SQL[[0;33mSELECT `template`,`title`,`title_rec` FROM `alert_templates` JOIN `alert_template_map` ON `alert_template_map`.`alert_templates_id`=`alert_templates`.`id` WHERE `alert_template_map`.`alert_rule_id`='8'[0m] 
Issuing Alert-UID #1463/1: ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; ; 